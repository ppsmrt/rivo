<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Rivo - Instagram Clone</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
<style>
  :root{
    --ig-grad: linear-gradient(45deg,#feda75 0%,#fa7e1e 25%,#d62976 50%,#962fbf 75%,#4f5bd5 100%);
  }
  .grad-icon{
    background: var(--ig-grad);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }
  .nav-glass{
    backdrop-filter: blur(6px);
    background: rgba(255,255,255,0.7);
  }
  .page{ display:none; }
  .page.active{ display:block; animation: fadeIn 0.25s ease; }
  @keyframes fadeIn{ from{opacity:0; transform:translateY(5px);} to{opacity:1; transform:translateY(0);} }
</style>
</head>
<body class="min-h-screen flex flex-col text-gray-900 bg-gray-50">

<!-- Header -->
<header class="sticky top-0 z-40 bg-white/80 backdrop-blur-sm border-b border-gray-200">
  <div class="max-w-3xl mx-auto flex items-center justify-between px-4 py-3">
    <div class="flex items-center gap-3">
      <i class="fa-solid fa-camera grad-icon text-2xl"></i>
      <h1 class="text-xl font-semibold">Rivo</h1>
    </div>
  </div>
</header>

<!-- Pages -->
<main class="flex-1 max-w-3xl mx-auto w-full px-4 py-6 space-y-6">

  <!-- Home Feed -->
  <section id="page-home" class="page active">
    <div id="feed" class="space-y-6"></div>
  </section>

  <!-- Search Page -->
  <section id="page-search" class="page">
    <div class="mb-4">
      <input id="searchInput" type="text" placeholder="Search users or posts..."
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500" />
    </div>
    <div id="searchResults" class="grid grid-cols-3 gap-2"></div>
  </section>

  <!-- Add Post Page -->
  <section id="page-post" class="page">
    <form id="addPostForm" class="space-y-4">
      <input type="file" id="postImage" accept="image/*" class="block w-full" required />
      <input type="text" id="postCaption" placeholder="Write a caption..."
        class="w-full px-4 py-2 border border-gray-300 rounded-lg" required />
      <button type="submit"
        class="w-full bg-rose-500 text-white py-2 rounded-lg font-semibold">Upload Post</button>
    </form>
    <p id="postStatus" class="mt-3 text-sm text-gray-500"></p>
  </section>

  <!-- Profile Page -->
  <section id="page-profile" class="page">
    <div class="flex items-center gap-4 mb-6">
      <img src="https://i.pravatar.cc/100?u=me" class="w-20 h-20 rounded-full" />
      <div>
        <p class="font-semibold text-lg">My Username</p>
        <p class="text-gray-500 text-sm">View and edit your profile</p>
      </div>
    </div>
    <div id="profilePosts" class="grid grid-cols-3 gap-1"></div>
  </section>

  <!-- Settings Page -->
  <section id="page-settings" class="page">
    <div class="space-y-4">
      <button class="w-full text-left px-4 py-2 bg-white rounded-lg shadow">Account Settings</button>
      <button class="w-full text-left px-4 py-2 bg-white rounded-lg shadow">Privacy</button>
      <button class="w-full text-left px-4 py-2 bg-white rounded-lg shadow">Log Out</button>
    </div>
  </section>

</main>

<!-- Bottom Navigation -->
<nav class="fixed bottom-4 left-0 right-0 flex justify-center pointer-events-none">
  <div class="w-full max-w-3xl px-4">
    <div class="nav-glass rounded-2xl shadow-lg flex justify-between items-center px-6 py-2 pointer-events-auto">
      <button data-page="home" class="text-2xl"><i class="fa-solid fa-house"></i></button>
      <button data-page="search" class="text-2xl"><i class="fa-solid fa-magnifying-glass"></i></button>
      <button data-page="post" class="text-2xl text-rose-500"><i class="fa-solid fa-square-plus"></i></button>
      <button data-page="profile" class="text-2xl"><i class="fa-regular fa-user"></i></button>
      <button data-page="settings" class="text-2xl"><i class="fa-solid fa-gear"></i></button>
    </div>
  </div>
</nav>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyCzi5YSMFfgnJF2xT29Yt8_PbpTyTt7Bdk",
    authDomain: "rivo-bea46.firebaseapp.com",
    databaseURL: "https://rivo-bea46-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "rivo-bea46",
    storageBucket: "rivo-bea46.firebasestorage.app",
    messagingSenderId: "9253016287",
    appId: "1:9253016287:web:f584476c79e78215f40f6a",
    measurementId: "G-RY85VPHXVP"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const storage = firebase.storage();

  // Nav switching
  const pages = document.querySelectorAll('.page');
  document.querySelectorAll('nav button').forEach(btn => {
    btn.addEventListener('click', () => {
      const target = 'page-' + btn.dataset.page;
      pages.forEach(p => p.classList.remove('active'));
      document.getElementById(target).classList.add('active');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  });

  // Home feed loader
  function loadFeed(){
    const feed = document.getElementById('feed');
    feed.innerHTML = '';
    db.ref('posts').limitToLast(10).on('child_added', snap => {
      const p = snap.val();
      const art = document.createElement('article');
      art.className = 'bg-white rounded-lg shadow-sm overflow-hidden';
      art.innerHTML = `
        <div class="flex items-center gap-3 p-4">
          <img src="${p.avatar}" class="w-10 h-10 rounded-full"/>
          <div class="flex-1">
            <p class="font-semibold text-sm">${p.user}</p>
            <p class="text-xs text-gray-500">${p.location || ''}</p>
          </div>
        </div>
        <img src="${p.image}" class="w-full"/>
        <div class="px-4 py-3">
          <p class="font-semibold text-sm">${p.likes || 0} likes</p>
          <p class="text-sm mt-1"><span class="font-semibold">${p.user}</span> ${p.caption}</p>
        </div>
      `;
      feed.prepend(art);
    });
  }
  loadFeed();

  // Add post
  document.getElementById('addPostForm').addEventListener('submit', e => {
    e.preventDefault();
    const file = document.getElementById('postImage').files[0];
    const caption = document.getElementById('postCaption').value;
    const status = document.getElementById('postStatus');
    if(!file) return;
    const ref = storage.ref('posts/' + Date.now() + '-' + file.name);
    ref.put(file).then(snap => snap.ref.getDownloadURL()).then(url => {
      const newPost = {
        user: 'myusername',
        avatar: 'https://i.pravatar.cc/150?u=me',
        image: url,
        caption: caption,
        likes: 0,
        timestamp: Date.now()
      };
      db.ref('posts').push(newPost);
      status.textContent = "Post uploaded successfully!";
      document.getElementById('addPostForm').reset();
    }).catch(err => {
      status.textContent = "Error uploading post: " + err.message;
    });
  });

  // Search
  document.getElementById('searchInput').addEventListener('input', e => {
    const term = e.target.value.toLowerCase();
    const results = document.getElementById('searchResults');
    results.innerHTML = '';
    db.ref('posts').once('value', snap => {
      snap.forEach(child => {
        const post = child.val();
        if(post.caption.toLowerCase().includes(term) || post.user.toLowerCase().includes(term)){
          const img = document.createElement('img');
          img.src = post.image;
          img.className = 'w-full h-32 object-cover';
          results.appendChild(img);
        }
      });
    });
  });

  // Profile loader
  function loadProfile(){
    const container = document.getElementById('profilePosts');
    container.innerHTML = '';
    db.ref('posts').orderByChild('user').equalTo('myusername').on('child_added', snap => {
      const post = snap.val();
      const img = document.createElement('img');
      img.src = post.image;
      img.className = 'w-full h-32 object-cover';
      container.appendChild(img);
    });
  }
  loadProfile();
</script>

</body>
</html>