<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rivo — Feed & Upload (Compressed + AES-GCM)</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <style>
    :root{--violet:#7c3aed}
    body{font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Arial;background:#f8fafc}
    .card{background:#fff;border-radius:12px;padding:12px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
    .upload-area{display:flex;gap:12px;align-items:center}
    .post-img{width:100%;border-radius:8px;display:block}
    .controls{display:flex;gap:8px;align-items:center}
  </style>
</head>
<body class="min-h-screen p-4">

  <header class="max-w-3xl mx-auto mb-4 flex items-center justify-between">
    <h1 class="text-2xl font-bold text-violet-600">Rivo</h1>
    <div id="auth-area">
      <button id="signInBtn" class="bg-violet-600 text-white px-3 py-1 rounded inline-flex items-center gap-2">
        <i class="fa-brands fa-google"></i><span>Sign in</span>
      </button>
      <div id="userBox" class="hidden items-center gap-2">
        <img id="userAvatar" class="w-8 h-8 rounded-full" src="">
        <span id="userName" class="text-sm"></span>
        <button id="signOutBtn" class="text-sm px-2 py-1">Sign out</button>
      </div>
    </div>
  </header>

  <main class="max-w-3xl mx-auto space-y-6">

    <!-- Upload card -->
    <section class="card">
      <div class="upload-area">
        <div style="flex:1">
          <label class="block text-sm font-semibold mb-1">Create post</label>
          <input id="imageInput" type="file" accept="image/*" class="mb-2" />
          <input id="captionInput" type="text" placeholder="Write a caption..." class="w-full border rounded px-3 py-2 mb-2" />
          <div class="controls">
            <button id="uploadBtn" class="bg-violet-600 text-white px-4 py-2 rounded">Upload (compress + encrypt)</button>
            <div id="uploadStatus" class="text-sm text-gray-600"></div>
          </div>
          <div class="text-xs text-gray-500 mt-2">Images are converted to WebP with aggressive compression and encrypted client-side (AES-GCM).</div>
        </div>
        <div style="width:160px">
          <div id="previewWrap" class="card" style="height:120px;display:flex;align-items:center;justify-content:center">
            <img id="preview" src="" alt="" style="max-width:100%;max-height:100%;display:none;border-radius:8px" />
            <div id="previewEmpty" class="text-xs text-gray-400">Preview</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Feed -->
    <section id="feedRoot" class="space-y-4">
      <div id="loading" class="text-center text-gray-500 py-8">Loading feed…</div>
    </section>

  </main>

  <!-- Shared JS modules -->
  <script type="module" src="assets/js/firebase-init.js"></script>
  <script type="module" src="assets/js/crypto-utils.js"></script>
  <script type="module" src="assets/js/upload.js"></script>
  <script type="module" src="assets/js/index.js"></script>

</body>
</html>